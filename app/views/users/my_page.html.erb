<div class ="container">
  <div class="mx-auto">
    <h2 class="my-5" id="page-title">マイページ</h2>
    <div class="text-right">
      <%= link_to 'プロフィール編集', users_my_page_edit_path(current_user), class: 'btn btn-success' %>
    </div>
    <!--目標値-->
    <div class="my-5 target">
      <h4 class="text-center">1日の消費カロリーとマクロ栄養素の目標値</h4>
      <table class='table text-center table-bordered w-75 mx-auto table-light' style='table-layout: fixed;'>
        <thead>
          <tr>
            <td>kcal</td>
            <td>たんぱく質</td>
            <td>脂質</td>
            <td>炭水化物</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><%= current_user.calorie %></td>
            <td><%= current_user.protain %></td>
            <td><%= current_user.fat %></td>
            <td><%= current_user.carbon %></td>
          </tr>
        </tbody>
      </table>
    </div>
    <!--食事内容-->
    <div class="my-5 food_regist">
      <h4 class="text-center"><%= Date.today %>の食事内容</h4>
      <table class='table text-center table-bordered table-light' style='table-layout: fixed;'>
        <thead>
          <tr>
            <td></td>
            <td>kcal</td>
            <td>たんぱく質</td>
            <td>脂質</td>
            <td>炭水化物</td>
            <td></td>
          </tr>
        </thead>
        <% @food_regists.each do |food_regist| %>
        <tbody>
          <tr>
            <td><%= food_regist.timing %> </td>
            <td><%= food_regist.food_regist_shows.aggregate(:calorie) %></td>
            <td><%= food_regist.food_regist_shows.aggregate(:calorie) %></td>
            <td><%= food_regist.food_regist_shows.aggregate(:calorie) %></td>
            <td><%= food_regist.food_regist_shows.aggregate(:calorie) %></td>
            <td>
              <%= link_to '詳細', food_regist_path(food_regist), class: 'btn btn-success' %>
              <%= link_to '編集', edit_food_regist_path(food_regist), class: 'btn btn-success' %>
            </td>
            <% end %>
          </tr>
          <tfoot>
            <tr>
              <td>合計</td>
              <td>
                <%= @food_regist_shows.aggregate(:calorie) %>
              </td>
              <td>
                <%= @food_regist_shows.aggregate(:protain) %>
              </td>
              <td>
                <%= @food_regist_shows.aggregate(:fat) %>
              </td>
              <td>
                <%= @food_regist_shows.aggregate(:carbon) %>
              </td>
              <td></td>
            </tr>
          </tfoot>
        </tbody>
      </table>
    </div>
    <!--カレンダー-->
    <%= month_calendar events: @food_regists do |date, food_regists| %>
      <%= date.day %>
      <% food_regists.each do |food_regist| %>
        <div>
          <%= food_regist.food_regist_shows.aggregate(:calorie) %>
        </div>
      <% end %>
    <% end %>
    <%= month_calendar events: @food_regist_shows do |date, food_regist_shows| %>
      <%= date.day %>
      <% food_regist_shows.each do |food_regist_show| %>
        <div>
          <%= @food_regist_shows.aggregate(:calorie) %>
        </div>
      <% end %>
    <% end %>
  </div>
</div>